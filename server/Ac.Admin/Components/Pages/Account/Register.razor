@page "/account/register"
@layout AuthLayout
@attribute [AllowAnonymous]

@inject NavigationManager Nav
@inject IConfiguration Config

<PageTitle>Регистрация — ActiveChat Admin</PageTitle>

<h5 class="text-center mb-4">Создать аккаунт</h5>

<p class="text-center text-muted small mb-4">
    Регистрация выполняется в центральном сервисе авторизации (Ac.Auth).
</p>

<div class="d-flex justify-content-center">
    <a href="@RegisterUrl" class="btn btn-primary">Перейти к регистрации в Ac.Auth</a>
</div>

<div class="mt-4 text-center small text-muted">
    <a href="/account/login" class="text-decoration-none">Уже есть аккаунт? Войти</a>
</div>

@code {
    private string RegisterUrl
    {
        get
        {
            var authority = (Config["Infra:AuthBaseUrl"] ?? Config["AuthForAdmin:Authority"])?.TrimEnd('/') ?? "https://localhost:7189";
            var returnUrl = Nav.ToAbsoluteUri("/account/login?registered=true").ToString();
            return $"{authority}/Account/Register?ReturnUrl={Uri.EscapeDataString(returnUrl)}";
        }
    }
}
